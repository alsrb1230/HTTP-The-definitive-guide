# HTTP 스터디 2주차 - URL과 리소스

**URL** : Uniform Resource Locator

- 브라우저가 정보를 찾는데 필요한 리소스의 위치를 가리킴
- 전자 정보 일부를 가리키고 그것이 어디에 있고, 어떻게 접근할 수 있는지 알려줌

**URN** : Uniform Resource Names

- 인터넷의 리소스 객체를 가리킬 수 있는 이름 제공
- 객체가 옮겨지더라도 (웹 서버 내, 웹 서버 간 모두) 항상 객체를 가리킬 수 있는 이름 제공

**URI** : Uniform Resource Identifier

- 통합 자원 식별자라고 불리는 일반화된 부류
- URL과 URN의 합집합

> 기존 URL이 옮겨지면, 그 시점에 기존 URL이 가리키고 있던 객체를 찾을 방법이 없어지는 문제가 존재<br>
> 👉🏻 추후에 URN으로의 변경 가능성이 있음 (하지만 긴급한 사안이 아님)

<br/><br/><br/>

# 1. 인터넷의 리소스 탐색

URL을 통해 사람과 어플리케이션이 인터넷상의 수십억 개의 리소스를 찾고 사용하며 공유할 수 있음

1. 사용자가 브라우저에 URL 입력
2. 브라우저는 사용자가 원하는 리소스를 얻기 위해 적절한 프로토콜을 이용하여 메세지 전송
3. 리소스 응답 받아 브라우저 랜더링 과정 진행

<br/><br/>

## 1-1. URL 형태

### 예시

```
http://www.joes-hardware,com/seasonal.index-fall.html
```

- `http` : URL의 스킴 **(어떻게)**
  - 스킴 : 웹 클라이언트가 리소스에 어떻게 접근하는지 명시
  - 해당 URL에서는 HTTP 프로토콜을 사용하여 접근함을 알 수 있음
- `www.joes-hardware.com` : 서버의 위치 **(어디에)**
  - 호스팅 되어있는 위치 명시
- `/seasonal/index-fall.html` : 리소스의 경로 **(무엇을)**
  - 서버에 존재하는 로컬 리소스들 중에서 ‘요청받은 리소스’가 무엇인지 명시

<br/>

### 문법

```
<스킴>://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>

-> 모든 컴포넌트를 가지는 URL은 거의 없음
```

- **스킴** : 리소스를 가져오려면 어떤 프로토콜을 사용하여 서버에 접근해야 하는가
- **사용자 이름** : 몇몇 스킴은 리소스 접근을 위해 사용자 이름 필요로 함
- **비밀번호** : 사용자의 비밀번호
- **호스트** : 리소스를 호스팅하는 서버의 호스트 명이나 IP 주소
- **포트** : 리소스를 호스팅하는 서버가 열어놓은 포트번호 (일반적으로 TCP 프로토콜 사용 HTTP는 80번)
- **경로** : 서버 내 리소스가 서버 어디에 있는지를 가리킴
- **파라미터** : 특정 스킴에서 입력 파라미터를 기술하는 용도 (이름/값 쌍을 가진다)
- **질의** : 스킴에서 어플리케이션에 파라미터를 전달하는데 쓰임
- **프래그먼트** : 리소스의 조각이나 일부분을 가리키는 이름
  - 브라우저가 서버로부터 전체 리소스를 다운 받은 후 → 프래그먼트 인식
  - 직접 서버에 전달되는 개체가 아니다.

<br/><br/>

## 1-2. 단축 URL

**절대 URL**

- 리소스에 접근하는 데 필요한 모든 정보를 가지고 있는 URL

**상대 URL**

- 모든 정보를 담고 있지 않은 URL (base : 기저 라고 하는 다른 URL을 사용)
- 프래그먼트이거나 절대 URL 일부

<br/>

### 예시

```
// tools.html

<html>
<head>Jiyoung's Tools</head>
<body>
  <h1>HeadLine</h1>
  <p>Jiyoung's Hardware Online has the largest selection of
    <a href="./hammers.html">hammers</a> on earth
  </p>
</body>
</html>
```

→ Jiyoung의 컴퓨터 가게 /tools.html 리소스를 기준으로 /hammers.html (하이퍼링크) 상대경로 명시

- 기저 URL

```
http://www.jiyoung-hardware.com/tools.html
```

- 상대 URL

```
./hammers.html
```

- 절대 URL

```
http://www.jiyoung-hardware.com/hammers.html
```

<br/>

### 상대 URL → 절대 URL 변환

1.  **기저 URL 찾기**
    1. 리소스에서 명시적으로 제공
    2. 특정 리소스에 포함 (기저 URL이 명시되어 있지 않는 리소스에 포함)
    3. 기저 URL이 없는 경우 : 절대 URL만으로 구성 or 불완전하거나 깨진 URL
2.  **상대 참조 해석**
    1.  상대 URL, 기저 URL을 각각의 컴포넌트 조각으로 나눈다. (URL 파싱, URL 분해)
    2.  알고리즘 사용하여 상대 URL → 리소스를 참조하는 데에 사용할 수 있는 절대 경로 형태로 변경
        알고리즘 예시)
        ![image](https://github.com/musinsa-global-developer-study/HTTP-The-definitive-guide/assets/72294509/530b6da6-9789-474f-85ef-432ec2a1129e)

<br/><br/>

## 1-3. URL 확장

URL을 입력한 다음이나, 입력하고 있는 동안에 자동으로 URL을 확장 (빠르게 입력하게 채워줌)

1. **호스트 명 확장**
   1. 단순한 휴리스틱만을 사용하여 입력한 호스트명을 전체 호스트 명으로 확장
   2. 관련 사이트를 찾지 못하면, 확장을 포기하기 전에 몇 가지의 URL을 추가로 제시
   3. ex) yahoo 입력 → `www`와 `.com`을 붙여 `www.yahoo.com` 생성
2. **히스토리 확장**
   1. 과거에 사용자가 방문했던 URL을 기반으로 제시

<br/><br/>

## 1-4. 안전하지 않은 문자 인코딩

URL에 알파벳 외의 문자도 포함하려고 할 때를 위해 **이스케이프**라는 기능을 추가하여, 안전하지 않은 문자를 안전한 문자로 인코딩

<br/>

### 인코딩

- 안전하지 않은 문자를 안전한 문자로 표현
- %(퍼센티지 기호)로 시작해 ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 ‘이스케이프’ 문자로 변환

- **인코딩 예시**

| 문자    | ASCII 코드 | URL 예                                               |
| ------- | ---------- | ---------------------------------------------------- |
| ~       | 126 (0x7E) | http://www.joes-hardware.com/%7Ejoe                  |
| 빈 문자 | 32 (0x20)  | http://www.joes-hardware.com/more%20tools.html       |
| %       | 37 (0x25)  | http://www.joes-hardware.com/100%25satisfaction.html |

<br/>

### 문자 제한

1. URL, 게이트웨이, 프로토콜에서 혼동을 일으킬 수 있는 문자들
2. US-ASCII의 출력 가능한 문자 집합에 포함되어 있지 않는 경우

위의 경우에는 인코딩이 필수로 진행되어야 다른 용도로 사용할 수 있다.

| 문자             | 선점 및 제한                                                                                                          |
| ---------------- | --------------------------------------------------------------------------------------------------------------------- |
| %                | 인코딩된 문자에 사용할 이스케이프 토큰으로 선점                                                                       |
| /                | 경로 컴포넌트에 있는 경로 세그먼트를 나누는 용도로 선점                                                               |
| .                | 경로 컴포넌트에서 선점                                                                                                |
| ..               | 경로 컴포넌트에서 선점                                                                                                |
| #                | 프래그먼트의 구획 문자로 선점                                                                                         |
| ?                | 질의 문자열의 구획 문자로 선점                                                                                        |
| ;                | 파라미터의 구획 문자로 선점                                                                                           |
| :                | 스킴, 사용자 이름/비밀번호, 호스트/포트의 구획 문자로 선점                                                            |
| $ + ,            | 선점                                                                                                                  |
| @ & =            | 특정 스킴에서 특별한 의미가 있기 때문에 선점                                                                          |
| {} \| \ ~ [] ₩ · | 게이트웨이와 같은 여러 전송 에이전트에서 불완전하게 다루기 때문에 제한됨                                              |
| <> “             | 안전하지 않음. 웹 문서에서 URL을 구분 지어 표시하듯이, URL 범위 밖에서 역할이 있는 문자이기 때문에 반드시 인코딩 필요 |
| 0x00-0x1F 0x7F   | 이 16진수 범위에 속하는 문자들은 인쇄되지 않는 US-ASCII 문자들.                                                       |
| > 0x7F           | 이 16진수 범위에 속하는 문자들은 7비트 US-ASCII 문자가 아님                                                           |

<br/><br/>

## 1-5. 스킴의 바다

- http
  - 사용자 이름, 비밀번호 없는 일반 URL 포맷을 지키는 HTTP 스킴
  - port: 80
- https
  - HTTP 양 끝단에서 SSL(Secure Sockets Layer) 사용
  - port: 443
- mailto
  - 이메일 주소를 가리키는 URL 포맷을 가지는 스킴
  - `mailto:jiyoung@naver.com`
- ftp
  - 일반적인 URL 포맷을 지키는 파일 전송 프토로콜(File Transfer Protocol) 스킴
  - `ftp://anonymous:password@prep.ai.mit.edu:21/pub/gnu`
- rtsp, rtspu
  - 실시간 스트리밍 프로토콜(Real Time Streaming Protocol)을 통해 읽을 수 있는 오디오, 비디오와 같은 미디어 리소스 식별자
  - `rtsp://www.musinsa-hardware.com:554/interview/cfo_video`
- file
  - 주어진 호스트 기기에서 바로 접근할 수 있는 파일들
  - 일반적인 URL 포맷을 따르며, 호스트 생략 시 URL 사용 기기의 로컬 호스트가 기본값
  - `file://OFFICE-FS/policies/casual-fridays.doc`
- news
  - 특정 문서나 뉴스 그룹에 접근하는데에 사용
  - URL이 리소스의 위치 정보를 충분히 포함하지 않는다는 특이한 특징
  - `news:rec.arts.startrek`
- telnet
  - 대화형 서비스에 접근하는데 사용
  - `telnel://slurp:webhound@joes-hardware.com:23/`
